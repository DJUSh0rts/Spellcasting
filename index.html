<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Spellcasting — Pack Generator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="styles.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
</head>
<body>
  <header class="bar">
    <div class="brand">Spellcasting Pack Generator</div>
    <div class="actions">
      <label class="muted">Import JSON <input type="file" id="importJson" accept="application/json"></label>
      <button id="exportJson" class="btn">Export JSON</button>
      <button id="exportZip" class="btn primary">Download ZIP</button>
    </div>
  </header>

  <main class="layout">
    <section class="panel">
      <h2>Pack Info</h2>
      <div class="form grid2">
        <label>Spell Name
          <input id="spellName" placeholder="leviosa" />
        </label>
        <label>Author
          <input id="author" placeholder="YourName" />
        </label>
        <label>Spell Delay (ticks)
          <input id="spellDelay" type="number" min="0" step="1" value="50" />
        </label>
      </div>

      <h3>Points</h3>
      <div class="points">
        <div class="points-list">
          <div id="pointsList"></div>
          <div class="row gap">
            <button id="addPointBtn" class="btn">+ Add Point</button>
            <button id="deletePointBtn" class="btn danger">Delete Point</button>
            <button id="clearPointBtn" class="btn">Clear Commands</button>
          </div>
        </div>

        <div class="point-editor">
          <div class="editor-head">
            <div id="selectedLabel" class="title">Point 0</div>
            <div class="row gap">
              <label>X <input id="offsetX" type="number" step="any" /></label>
              <label>Y <input id="offsetY" type="number" step="any" /></label>
              <label>Z <input id="offsetZ" type="number" step="any" /></label>
              <button id="resetOffset" class="btn">Reset</button>
            </div>
          </div>

          <div class="grid-wrap">
            <div class="grid-title">XY Grid (3×3, center = 0,0)</div>
            <div class="gridBox">
              <canvas id="gridCanvas" width="180" height="180"></canvas>
              <div id="gridThumb"></div>
            </div>
          </div>

          <div class="commands-wrap">
            <div class="row between">
              <h4>Point Commands</h4>
              <button id="addCmdBtn" class="btn">+ Add Command</button>
            </div>
            <div id="commands"></div>
          </div>

          <div class="preview">
            <h4>Selected Point Preview</h4>
            <pre id="preview"></pre>
          </div>
        </div>
      </div>
    </section>

    <section class="panel">
      <h2>Finish (After-Cast) Function</h2>
      <p class="muted small">These run <em>after</em> the pattern completes, followed by any raycasts you add.</p>
      <textarea id="afterFunction" class="code" placeholder="# one command per line
say Finished!
$execute as @s run say Uses macros like $(UUID) if you need"></textarea>

      <h2>Raycasts</h2>
      <div class="row gap">
        <button id="addRayBtn" class="btn">+ Add Raycast</button>
      </div>
      <div id="raysContainer" class="stack"></div>

      <div class="overview">
        <h3>Path Overview</h3>
        <svg id="overviewSvg" viewBox="0 0 180 180" width="180" height="180" class="overviewSvg"></svg>
      </div>

      <div id="status" class="status"></div>
    </section>
  </main>

  <footer class="foot muted small">
    Spellcasting — Build more spells at your leisure.
  </footer>

  <script src="script.js"></script>
</body>
</html>
